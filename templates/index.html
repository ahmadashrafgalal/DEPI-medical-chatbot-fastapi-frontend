<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Chatbot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.10.1/dist/full.min.css" rel="stylesheet" type="text/css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        .message-bubble {
            animation: messageSlide 0.3s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .typing-pulse {
            animation: typingPulse 1.4s infinite;
        }

        @keyframes typingPulse {
            0%, 60%, 100% { opacity: 0.5; }
            30% { opacity: 1; }
        }

        .send-btn-hover:hover {
            transform: rotate(-15deg) scale(1.05);
        }

        .send-btn-hover {
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .quick-btn {
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: #e0e7ff;
        }

        .quick-btn:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: rgba(99, 102, 241, 0.6);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        input::placeholder {
            color: rgba(226, 232, 240, 0.5);
        }

        .avatar-icon {
            font-size: 2.5rem;
            line-height: 1;
        }
    </style>
</head>
<body class="min-h-screen overflow-hidden">
    <div class="gradient-bg"></div>

    <div class="relative z-10 flex items-center justify-center min-h-screen p-4">
        <div class="glass-card rounded-2xl w-full max-w-2xl h-[80vh] flex flex-col overflow-hidden">
            
            <div class="bg-gradient-to-r from-indigo-500/10 via-transparent to-purple-500/10 border-b border-white/10 px-6 py-6 flex items-center gap-4">
                <div class="w-16 h-16 rounded-full bg-gradient-to-br from-indigo-400 to-purple-600 flex items-center justify-center flex-shrink-0">
                    <span class="avatar-icon">üè•</span>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-white">Medical Chatbot</h1>
                    <p class="text-sm text-slate-300">Ask me anything</p>
                </div>
            </div>

            <div id="chatContainer" class="flex-1 overflow-y-auto scrollbar-hide px-6 py-6 space-y-4">
                <div class="message-bubble flex justify-start">
                    <div class="max-w-xs lg:max-w-md bg-slate-700/70 text-slate-200 rounded-2xl px-4 py-3">
                        <p class="text-sm leading-relaxed">Hello! üëã I'm your medical assistant. Feel free to ask me about symptoms, medications, or book an appointment. How can I help you today?</p>
                    </div>
                </div>
            </div>

            <div class="px-6 py-4 border-t border-white/10">
                <div class="flex gap-2 overflow-x-auto scrollbar-hide">
                    <button onclick="quickAction('Check symptoms')" class="quick-btn px-4 py-2 rounded-full text-sm font-medium flex-shrink-0 whitespace-nowrap">
                        üîç Check symptoms
                    </button>
                    <button onclick="quickAction('Medication info')" class="quick-btn px-4 py-2 rounded-full text-sm font-medium flex-shrink-0 whitespace-nowrap">
                        üíä Medication info
                    </button>
                    <button onclick="quickAction('Book appointment')" class="quick-btn px-4 py-2 rounded-full text-sm font-medium flex-shrink-0 whitespace-nowrap">
                        üìÖ Book appointment
                    </button>
                </div>
            </div>

            <div class="bg-gradient-to-t from-white/5 to-transparent border-t border-white/10 px-6 py-4">
                <div class="flex gap-3">
                    <input
                        id="messageInput"
                        type="text"
                        placeholder="Type your medical question‚Ä¶"
                        class="flex-1 bg-white/8 border border-white/15 rounded-xl px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all"
                        onkeypress="handleKeyPress(event)"
                    />
                    <button 
                        onclick="sendMessage()" 
                        class="send-btn-hover bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white rounded-xl px-4 py-3 font-semibold flex items-center justify-center"
                    >
                        <span>‚úàÔ∏è</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const chatContainer = document.getElementById('chatContainer');
        const messageInput = document.getElementById('messageInput');

        function scrollToBottom() {
            setTimeout(() => {
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 0);
        }

        function addUserBubble(message) {
            const div = document.createElement('div');
            div.className = 'message-bubble flex justify-end';
            
            const bubble = document.createElement('div');
            bubble.className = 'max-w-xs lg:max-w-md bg-gradient-to-br from-indigo-500 to-indigo-600 text-white rounded-2xl px-4 py-3';
            bubble.textContent = message;
            
            div.appendChild(bubble);
            chatContainer.appendChild(div);
            scrollToBottom();
        }

        function addBotBubble(message) {
            const div = document.createElement('div');
            div.className = 'message-bubble flex justify-start';
            
            const bubble = document.createElement('div');
            bubble.className = 'max-w-xs lg:max-w-md bg-slate-700/70 text-slate-200 rounded-2xl px-4 py-3';
            bubble.textContent = message;
            
            div.appendChild(bubble);
            chatContainer.appendChild(div);
            scrollToBottom();
        }

        function addTypingBubble() {
            const div = document.createElement('div');
            div.id = 'typingBubble';
            div.className = 'message-bubble flex justify-start';
            
            const bubble = document.createElement('div');
            bubble.className = 'max-w-xs lg:max-w-md bg-slate-700/70 text-slate-200 rounded-2xl px-4 py-3';
            bubble.innerHTML = '<span class="typing-pulse">MedBot is typing‚Ä¶</span>';
            
            div.appendChild(bubble);
            chatContainer.appendChild(div);
            scrollToBottom();
        }

        function removeTypingBubble() {
            const typingBubble = document.getElementById('typingBubble');
            if (typingBubble) {
                typingBubble.remove();
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            messageInput.value = '';
            addUserBubble(message);
            addTypingBubble();

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ msg: message })
                });

                const data = await response.json();
                removeTypingBubble();
                addBotBubble(data.response);
            } catch (error) {
                removeTypingBubble();
                addBotBubble('Sorry, there was an error processing your request.');
                console.error('Error:', error);
            }

            messageInput.focus();
        }

        function quickAction(action) {
            messageInput.value = action;
            messageInput.focus();
            sendMessage();
        }

        window.addEventListener('load', () => {
            messageInput.focus();
        });
    </script>
</body>
</html>
